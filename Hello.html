<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Will You Be My Valentine? ğŸ’•</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body{
    font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
    background: radial-gradient(circle at center,#1a5c4a 0%,#0a2e24 100%);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    padding:10px;
    overflow:hidden;
}

#container{
    background:#fffafa;
    padding:20px;
    border-radius:25px;
    box-shadow:0 30px 80px rgba(0,0,0,.6);
    max-width:850px;
    width:100%;
    text-align:center;
    border:8px solid #5d2e0c;
    position:relative;
}

h1{color:#c41e3a;margin-bottom:10px;font-size:1.8rem;}

#gameCanvas{
    background:#1a8a5d;
    border:12px solid #4a2508;
    border-radius:15px;
    display:block;
    margin:15px auto;
    width:100%;
    max-width:700px;
    height:auto;
    touch-action:none; /* IMPORTANT */
}

.stat-bar{
    display:flex;
    justify-content:space-around;
    margin-bottom:12px;
    gap:6px;
}

.stat{
    background:#0f4c3a;
    color:white;
    padding:8px 12px;
    border-radius:10px;
    font-weight:bold;
    font-size:.9rem;
}

button{
    background:#c41e3a;
    color:white;
    border:none;
    padding:12px 28px;
    font-size:1.05rem;
    border-radius:40px;
    cursor:pointer;
    font-weight:bold;
    margin:8px;
}

.hidden{display:none!important;}

#powerMeter{
    width:240px;height:16px;background:#ddd;border-radius:20px;
    margin:8px auto;border:3px solid #333;overflow:hidden;
}
#powerFill{height:100%;width:0%;background:linear-gradient(90deg,#4caf50,#ffeb3b,#f44336);}

#overlay{
    position:absolute;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,.85);
    display:flex;align-items:center;justify-content:center;
    border-radius:22px;
}

.modal{
    background:white;padding:25px;border-radius:20px;
    max-width:85%;
}

#noBtn{background:#ff9800;position:absolute;}
#yesBtn{background:#4caf50;}

@media(max-width:600px){
    h1{font-size:1.4rem;}
    .stat{font-size:.75rem;}
    button{font-size:.95rem;}
}
</style>
</head>

<body>

<div id="container">

<div id="startScreen">
<h1>ğŸ± Our Memory Pool ğŸ’•</h1>
<button onclick="startGame()">Play Game ğŸ±</button>
</div>

<div id="gameScreen" class="hidden">
<div class="stat-bar">
<div class="stat">ğŸ¯ <span id="shotsCount">15</span></div>
<div class="stat">â±ï¸ <span id="timerCount">120</span>s</div>
<div class="stat">âœ… <span id="progressCount">0/7</span></div>
</div>

<canvas id="gameCanvas"></canvas>
<div id="powerMeter"><div id="powerFill"></div></div>
</div>

<div id="winScreen" class="hidden">
<h1>Perfect Game! ğŸ’–</h1>
<h2>Will you be my Valentine?</h2>

<div style="height:160px;position:relative;">
<button id="yesBtn" onclick="celebrate()">YES! ğŸ’•</button>
<button id="noBtn" onmouseover="dodge()" onclick="dodge()">No...</button>
</div>
</div>

<div id="celebrationScreen" class="hidden">
<h1 style="font-size:3rem;">ğŸ‰ ğŸ’• ğŸŒ¹</h1>
<h1 style="color:#c41e3a;">Love you Bubu!</h1>
</div>

<div id="overlay" class="hidden">
<div class="modal">
<h2>Oops!</h2>
<p id="loseMsg"></p>
<button onclick="resetGame()">Try Again</button>
</div>
</div>

</div>

<script>

const MEMORIES=["Paddock Lounge","AM PM","LBS","Siciliana","Lyla","Avartana","Chota Paneer"];
const DECOYS=["Hopipola","Romania","Peshawari","Nutcase"];
const COLORS=['#f44336','#2196f3','#ffeb3b','#9c27b0','#ff9800','#4caf50','#795548'];

let canvas,ctx,balls=[],cue,timer;
let shots=15,time=120,sunkCount=0,lives=2;
let isMoving=false,isCharging=false,power=0;
let active=false,gameEnded=false;
let mouseX=0,mouseY=0;

const BALL_RADIUS=22;

function startGame(){
document.getElementById('startScreen').classList.add('hidden');
document.getElementById('gameScreen').classList.remove('hidden');
initCanvas();
resetGame();
}

function initCanvas(){

canvas=document.getElementById('gameCanvas');
ctx=canvas.getContext('2d');

resizeCanvas();
window.addEventListener('resize',resizeCanvas);

/* TOUCH + MOUSE unified */
function getPos(e){
const rect=canvas.getBoundingClientRect();
const touch=e.touches?e.touches[0]:e;
return{
x:(touch.clientX-rect.left)*(canvas.width/rect.width),
y:(touch.clientY-rect.top)*(canvas.height/rect.height)
};
}

canvas.addEventListener('mousemove',e=>{
let p=getPos(e);mouseX=p.x;mouseY=p.y;
});

canvas.addEventListener('touchmove',e=>{
e.preventDefault();
let p=getPos(e);mouseX=p.x;mouseY=p.y;
},{passive:false});

canvas.addEventListener('mousedown',()=>{if(!isMoving)isCharging=true;});
canvas.addEventListener('touchstart',e=>{
e.preventDefault();
if(!isMoving)isCharging=true;
},{passive:false});

window.addEventListener('mouseup',shoot);
window.addEventListener('touchend',shoot);
}

function resizeCanvas(){
const rect=canvas.getBoundingClientRect();
const dpr=window.devicePixelRatio||1;

canvas.width=rect.width*dpr;
canvas.height=(rect.width*0.57)*dpr;

ctx.setTransform(1,0,0,1,0,0);
ctx.scale(dpr,dpr);
}

function shoot(){
if(isCharging){
let dx=mouseX-cue.x;
let dy=mouseY-cue.y;
let angle=Math.atan2(dy,dx);

cue.vx=-Math.cos(angle)*Math.max(power,5);
cue.vy=-Math.sin(angle)*Math.max(power,5);

shots--;
updateUI();
}
isCharging=false;
power=0;
document.getElementById('powerFill').style.width='0%';
}

function resetGame(){

active=true;
gameEnded=false;
shots=15;
time=120;
sunkCount=0;
balls=[];

cue={x:180,y:200,vx:0,vy:0,r:BALL_RADIUS,isCue:true,alive:true};
balls.push(cue);

let all=[
...MEMORIES.map((n,i)=>({n,c:COLORS[i%COLORS.length],imp:true})),
...DECOYS.map(n=>({n,c:'#333',imp:false}))
].sort(()=>Math.random()-0.5);

let startX=420,startY=200,row=0,co
